"use strict";(self.webpackChunkfigment_documentation=self.webpackChunkfigment_documentation||[]).push([[435],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,s=d(e,["components","mdxType","originalType","parentName"]),p=c(n),f=r,m=p["".concat(l,".").concat(f)]||p[f]||u[f]||i;return n?a.createElement(m,o(o({ref:t},s),{},{components:n})):a.createElement(m,o({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=f;var d={};for(var l in t)hasOwnProperty.call(t,l)&&(d[l]=t[l]);d.originalType=e,d[p]="string"==typeof e?e:r,o[1]=d;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},746:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>d,toc:()=>c});var a=n(87462),r=(n(67294),n(3905));const i={title:"Create Withdrawal Transaction",slug:"/guides/staking-api/polkadot/undelegate/create-withdrawal-transaction"},o=void 0,d={unversionedId:"guides/staking-api/Polkadot/undelegate/create-withdraw-transaction",id:"guides/staking-api/Polkadot/undelegate/create-withdraw-transaction",title:"Create Withdrawal Transaction",description:"This transaction be created directly from initializing or after the unbonding flow.",source:"@site/docs/guides/staking-api/Polkadot/undelegate/9_create-withdraw-transaction.mdx",sourceDirName:"guides/staking-api/Polkadot/undelegate",slug:"/guides/staking-api/polkadot/undelegate/create-withdrawal-transaction",permalink:"/guides/staking-api/polkadot/undelegate/create-withdrawal-transaction",draft:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{title:"Create Withdrawal Transaction",slug:"/guides/staking-api/polkadot/undelegate/create-withdrawal-transaction"},sidebar:"docsSidebar",previous:{title:"Submit Signed Unbond Transaction for Broadcast",permalink:"/guides/staking-api/polkadot/undelegate/submit-signed-unbond-transaction"},next:{title:"Sign Withdrawal Transaction",permalink:"/guides/staking-api/polkadot/undelegate/sign-withdrawal-transaction"}},l={},c=[{value:"Parameters",id:"parameters",level:3},{value:"Sample cURL Request",id:"sample-curl-request",level:3},{value:"Response",id:"response",level:3},{value:"Sample Response",id:"sample-response",level:4}],s={toc:c};function p(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This transaction be created directly from initializing ",(0,r.kt)("em",{parentName:"p"},"or")," after the unbonding flow."),(0,r.kt)("p",null,"When creating this transaction directly after initializing, the inputs will be required for the stash account address, controller account address, and an optional controller proxy account address.\nOtherwise, ",(0,r.kt)("inlineCode",{parentName:"p"},"inputs")," will not be required."),(0,r.kt)("p",null,"If the information ",(0,r.kt)("strong",{parentName:"p"},"has not")," been collected:"),(0,r.kt)("p",null,"After collecting the required inputs, send a ",(0,r.kt)("inlineCode",{parentName:"p"},"PUT")," request to ",(0,r.kt)("inlineCode",{parentName:"p"},"/api/v1/flows/[:flow_id]/next")," to proceed to the next step."),(0,r.kt)("h3",{id:"parameters"},"Parameters"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"name")," ","\u2014"," ",(0,r.kt)("inlineCode",{parentName:"li"},"string")," Name of the action to execute (required)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"inputs")," ","\u2014"," ",(0,r.kt)("inlineCode",{parentName:"li"},"object")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"controller_account_address")," ","\u2014"," ",(0,r.kt)("inlineCode",{parentName:"li"},"string")," Address of the wallet DOT will be bonded to (required)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"controller_proxy_account_address")," ","\u2014"," ",(0,r.kt)("inlineCode",{parentName:"li"},"string")," A proxy account that will sign on behalf of the controller account (optional)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"stash_account_address")," ","\u2014"," ",(0,r.kt)("inlineCode",{parentName:"li"},"string")," Primary wallet from which DOT will be bonded (required)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"amount")," ","\u2014"," ",(0,r.kt)("inlineCode",{parentName:"li"},"number"),' The amount of DOT to be bonded to the controller. This field should be in full DOT, not in Planck (i.e., if you want to stake 5 DOT, return "amount": 5.0). Staking API will translate the amount to Plancks so you do not have to worry about the conversion factor (required).'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"maximum")," ","\u2014"," ",(0,r.kt)("inlineCode",{parentName:"li"},"boolean")," Set this to ",(0,r.kt)("inlineCode",{parentName:"li"},"true")," if you want to unbond the maximum amount of tokens (optional).")),(0,r.kt)("h3",{id:"sample-curl-request"},"Sample cURL Request"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:"{5-9}","{5-9}":!0},'curl -X PUT \'https://polkadot-slate.datahub.figment.io/api/v1/flows/86d9a004-12b6-4142-90cb-9ade53864e29/next\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Authorization: <api_key>\' \\\n-d \'{\n  "name": "create_withdraw_tx",\n  "inputs": {\n    "controller_account_address": "5GNhcVwpjND83kk6uqMeCjXNUnTSdz84SFyJmd3NmZe4uvrC",\n    "stash_account_address": "5GQmooiNwLwjXnsNp3woVDD3xhkHzcifVVAmdWcb6FaRVA4L"\n  }\n}\'\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"If this is following the flow from unbonding, no inputs are required!")),(0,r.kt)("p",null,"Now that the account is unbonded, submit a withdraw transaction to withdraw from the stake."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:"{5-6}","{5-6}":!0},"curl -X PUT 'https://polkadot-slate.datahub.figment.io/api/v1/flows/86d9a004-12b6-4142-90cb-9ade53864e29/next' \\\n-H 'Content-Type: application/json' \\\n-H 'Authorization: <api_key>' \\\n-d '{\n  \"name\": \"create_withdraw_tx\",\n  \"inputs\": {}\n}'\n")),(0,r.kt)("h3",{id:"response"},"Response"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"After creating the withdraw transaction, the rest will follow the same in both cases"),":"),(0,r.kt)("p",null,"We see two possible ",(0,r.kt)("inlineCode",{parentName:"p"},"actions"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"refresh_withdraw_tx")," ","\u2014"," If you need to get a fresh version of the transaction payload (i.e., the nonce needs to be updated)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"sign_withdraw_tx")," ","\u2014"," Submit a signed transaction payload ready to be broadcast to the network.")),(0,r.kt)("p",null,"We will choose ",(0,r.kt)("inlineCode",{parentName:"p"},"sign_withdraw_tx"),", which indicates one input to collect:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"transaction_payload")," ","\u2014"," the signed transaction payload ready to be broadcast to the network")),(0,r.kt)("h4",{id:"sample-response"},"Sample Response"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:"{6,10,19}","{6,10,19}":!0},'{\n  "id": "86d9a004-12b6-4142-90cb-9ade53864e29",\n  "state": "withdraw_tx_signature",\n  "actions": [\n    {\n      "name": "refresh_withdraw_tx",\n      "inputs": []\n    },\n    {\n      "name": "sign_withdraw_tx",\n      "inputs": [\n        {\n          "name": "transaction_payload",\n          "display": "Transaction Payload",\n          "description": "",\n          "type": "signed_transaction",\n          "validations": [],\n          "signers": ["5GNhcVwpjND83kk6uqMeCjXNUnTSdz84SFyJmd3NmZe4uvrC"],\n          "transaction_payload": "0x0024000000000000000000e143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423ee143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423e000000000000000000000000000000000000000000000000000000000000000000000000000603000000001c77657374656e64387061726974792d77657374656e64020000004a2400000000000040df6acb689907609b0400000037e397fc7c91f5e40100000040fe3ad401f8959a06000000d2bc9897eed08f1503000000f78b278be53f454c02000000af2c0297a23e6d3d0200000049eaaf1b548a0cb00100000091d5df18b0d2cf5801000000ed99c5acb25eedf503000000cbca25e39f14238702000000687ad44ad37f03c201000000ab3c0572291feb8b01000000bc9d89904f5b923f0100000037c8bb1350a9a2a801000000f3ff14d5ab5270590100000017a6bc0d0062aeb3010000000c0000000004"\n        },\n        {\n          "name": "signatures",\n          "display": "Signatures",\n          "description": "",\n          "type": "array_of_signatures",\n          "validations": [],\n          "signers": ["5GNhcVwpjND83kk6uqMeCjXNUnTSdz84SFyJmd3NmZe4uvrC"],\n          "transaction_payload": "0x0024000000000000000000e143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423ee143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423e000000000000000000000000000000000000000000000000000000000000000000000000000603000000001c77657374656e64387061726974792d77657374656e64020000004a2400000000000040df6acb689907609b0400000037e397fc7c91f5e40100000040fe3ad401f8959a06000000d2bc9897eed08f1503000000f78b278be53f454c02000000af2c0297a23e6d3d0200000049eaaf1b548a0cb00100000091d5df18b0d2cf5801000000ed99c5acb25eedf503000000cbca25e39f14238702000000687ad44ad37f03c201000000ab3c0572291feb8b01000000bc9d89904f5b923f0100000037c8bb1350a9a2a801000000f3ff14d5ab5270590100000017a6bc0d0062aeb3010000000c0000000004",\n          "signing_payload": "0x0603000000000024004a2400000c000000e143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423ee143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423e"\n        }\n      ]\n    }\n  ],\n  "data": {\n    "controller_account_address": "5GNhcVwpjND83kk6uqMeCjXNUnTSdz84SFyJmd3NmZe4uvrC",\n    "controller_proxy_account_address": null,\n    "stash_account_address": "5GQmooiNwLwjXnsNp3woVDD3xhkHzcifVVAmdWcb6FaRVA4L",\n    "amount": null,\n    "maximum": null,\n    "chill_transaction": null,\n    "estimated_chilled_at": null,\n    "unbond_transaction": null,\n    "unbonding_era": null,\n    "estimated_unbonded_at": null,\n    "withdraw_transaction": {\n      "raw": "0x0024000000000000000000e143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423ee143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423e000000000000000000000000000000000000000000000000000000000000000000000000000603000000001c77657374656e64387061726974792d77657374656e64020000004a2400000000000040df6acb689907609b0400000037e397fc7c91f5e40100000040fe3ad401f8959a06000000d2bc9897eed08f1503000000f78b278be53f454c02000000af2c0297a23e6d3d0200000049eaaf1b548a0cb00100000091d5df18b0d2cf5801000000ed99c5acb25eedf503000000cbca25e39f14238702000000687ad44ad37f03c201000000ab3c0572291feb8b01000000bc9d89904f5b923f0100000037c8bb1350a9a2a801000000f3ff14d5ab5270590100000017a6bc0d0062aeb3010000000c0000000004",\n      "signing_payload": "0x0603000000000024004a2400000c000000e143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423ee143f23803ac50e8f6f8e62695d1ce9e4e1d68aa36c1cd2cfd15340213f3423e",\n      "signed": null,\n      "hash": null,\n      "status": null,\n      "error": null,\n      "signatures": null,\n      "block_number": null,\n      "proxy": false\n    }\n  },\n  "network_code": "polkadot",\n  "chain_code": "westend",\n  "created_at": "2022-10-07T14:06:47.401Z",\n  "updated_at": "2022-10-07T14:09:48.400Z"\n}\n')),(0,r.kt)("admonition",{title:"note",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Make sure to save the ",(0,r.kt)("inlineCode",{parentName:"p"},"transaction_payload")," from this response, which is what needs to be signed in the next step.")))}p.isMDXComponent=!0}}]);